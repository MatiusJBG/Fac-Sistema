<div class="nuevo-producto-modal">
    <div class="modal-header">
        <h2 class="modal-title">Nuevo Producto</h2>
        <button class="btn-guardar" @onclick="GuardarProducto">
            <i class="bi bi-check-lg me-1"></i>Guardar
        </button>
    </div>
    <div class="modal-body">
        <EditForm Model="@NuevoProductoModel" OnValidSubmit="GuardarProducto">
            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="form-group">
                <label for="tipPro">Tipo de Producto</label>
                <InputSelect id="tipPro" @bind-Value="NuevoProductoModel.Tip_Pro" class="form-control">
                    <option value="">Seleccionar...</option>
                    <option value="Alimento">Alimento</option>
                    <option value="Bebida">Bebida</option>
                    <option value="Limpieza">Limpieza</option>
                    <option value="Higiene">Higiene</option>
                    <option value="Otro">Otro</option>
                </InputSelect>
            </div>

            <div class="form-group">
                <label for="nomPro">Nombre de Producto</label>
                <InputText id="nomPro" @bind-Value="NuevoProductoModel.Nom_Pro" class="form-control" placeholder="Ingrese el nombre del producto" />
            </div>

            <div class="form-group">
                <label for="fecExpPro">Fecha de Expiración</label>
                <InputDate id="fecExpPro" @bind-Value="NuevoProductoModel.Fec_Exp_Pro" class="form-control" />
            </div>

            <div class="form-group">
                <label for="canPro">Cantidad</label>
                <InputNumber id="canPro" @bind-Value="NuevoProductoModel.Can_Pro" class="form-control" min="1" placeholder="0" />
            </div>

            <div class="form-group">
                <label for="preUni">Precio Unitario</label>
                <InputNumber id="preUni" @bind-Value="NuevoProductoModel.Pre_Uni" class="form-control" step="0.01" min="0" placeholder="0.00" />
            </div>
        </EditForm>
    </div>
</div>


@using Application.DTOs

@using UI.Blazor.Cliente.Models

@code {
    // Modelo para nuevo producto
    public Producto NuevoProductoModel { get; set; } = new();

    // Eventos
    [Parameter] public EventCallback<Producto> OnGuardar { get; set; }
    [Parameter] public EventCallback OnCerrar { get; set; }

    // Método para invocar OnCerrar
    private async Task CerrarModal()
    {
        if (OnCerrar.HasDelegate)
        {
            await OnCerrar.InvokeAsync();
        }
    }

    private async Task GuardarProducto()
    {
        if (OnGuardar.HasDelegate)
        {
            await OnGuardar.InvokeAsync(NuevoProductoModel);
        }
    }

    public void ResetForm()
    {
        NuevoProductoModel = new Producto
        {
            Fec_Exp_Pro = DateTime.Now.AddMonths(6) // Valor por defecto
        };
        StateHasChanged();
    }
}